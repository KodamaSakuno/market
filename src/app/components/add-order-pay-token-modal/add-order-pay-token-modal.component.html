<div class="modal-header">
  <h4 class="modal-title" id="modal-basic-title">支付 {{ tokenService.symbol }}</h4>
  <button type="button" class="close" aria-label="Close" (click)="activeModal.dismiss()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<div class="modal-body">
  <div class="d-flex flex-wrap mb-3">
    <label style="width: 100%">{{ tokenService.symbol }}</label>
    <app-amount-input [(amount)]="amount" [decimals]="tokenService.decimals" [min]="deposit" [max]="max" #input></app-amount-input>
    <button class="btn btn-primary" (click)="amount = deposit">保证金</button>
    <button class="btn btn-primary" (click)="amount = max">最大值</button>
  </div>
  <span *ngIf="allowance.isNaN()">获取配额中……</span>
  <div *ngIf="isInsuffientAllowance">
    <p>抱歉，现在配额不足，需要进行两次支付，目前为第一次授权额度</p>
    当前配额：{{ allowance | bignumber:tokenService.decimals }} <button class="btn btn-primary" (click)="refreshAllowance()">刷新</button>
    <app-qrcode [to]="tokenService.contractAddress" func="approve" [args]="[marketService.contractAddress, allowance, amount]" (success)="refreshAllowance()"></app-qrcode>
  </div>
  <div *ngIf="!allowance.isNaN() && !isInsuffientAllowance && !input.isInvalid">
    现在配额足够
    <app-qrcode [to]="marketService.contractAddress" func="addOrderWithToken" [args]="[tokenService.contractAddress, orderValueArg, orderAmountArg, amount]" (success)="activeModal.close()"></app-qrcode>
  </div>
</div>
